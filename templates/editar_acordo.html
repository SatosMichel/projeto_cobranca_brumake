<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Editar Acordo</title>
  <style>
    label { display:block; margin-top:8px; }
    .erro { color: red; }
    .hidden { display: none; }
    .show { display: block; }
    /* layout for payment options */
    .payment-options { display: flex; flex-direction: column; gap: 6px; margin-top: 4px; }
    .payment-option { display: flex; align-items: center; gap: 8px; }
    .payment-option input[type="radio"] { margin: 0; }
    /* bank fields layout */
    .bank-row { display: flex; gap: 12px; align-items: center; margin-top: 8px; }
    .bank-row label { display: flex; flex-direction: column; flex: 1; }
    .bank-row input[type="text"] { width: 100%; max-width: 360px; padding: 6px 8px; box-sizing: border-box; }
    @media (max-width: 480px) {
      .bank-row { flex-direction: column; }
      .bank-row input[type="text"] { max-width: 100%; }
    }
  </style>
</head>
<body>
  <h1>Editar Acordo #{{ acordo.id }}</h1>
  {% if erro %}
    <p class="erro">{{ erro }}</p>
  {% endif %}
  <form method="post">
    <p><strong>Nome:</strong> {{ acordo.nome }}</p>
    <p><strong>Valor Nominal:</strong> {{ acordo.valor_nominal }}</p>
    <p><strong>Parcelas:</strong> {{ acordo.parcelas }}</p>

    <label>Forma de pagamento:</label>
    <div class="payment-options">
      <label class="payment-option"><input type="radio" name="forma_pagamento" value="Pix" {% if acordo.forma_pagamento == 'Pix' %}checked{% endif %}><span>Pix</span></label>
      <label class="payment-option"><input type="radio" name="forma_pagamento" value="Transferencia" {% if acordo.forma_pagamento == 'Transferencia' %}checked{% endif %}><span>Transferência bancária</span></label>
    </div>

    <div id="bank_fields" class="{% if acordo.forma_pagamento == 'Transferencia' %}show{% else %}hidden{% endif %}" style="margin-top:8px;">
      <div class="bank-row">
        <label>Agência: <input type="text" name="agencia" value="{{ acordo.agencia }}"></label>
        <label>Conta: <input type="text" name="conta" value="{{ acordo.conta }}"></label>
      </div>
    </div>

    <label>Senha SUP (necessária para confirmar edição): <input type="password" name="sup_password"></label>

    <button type="submit">Salvar alterações</button>
    <a href="{{ url_for('acordo_detalhe', acordo_id=acordo.id) }}">Cancelar</a>
  </form>

  <script>
    const radios = document.querySelectorAll('input[name="forma_pagamento"]');
    const bankFields = document.getElementById('bank_fields');
    radios.forEach(r => r.addEventListener('change', () => {
      if (r.value === 'Transferencia' && r.checked) {
        bankFields.classList.remove('hidden');
        bankFields.classList.add('show');
      } else if (r.value === 'Pix' && r.checked) {
        bankFields.classList.remove('show');
        bankFields.classList.add('hidden');
      }
    }));
  </script>
</body>
</html>